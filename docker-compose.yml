version: '2.1'

volumes:
    adguardhome_work:
    adguardhome_conf:

services:

    # https://hub.docker.com/r/adguard/adguardhome
    adguard:
        image: adguard/adguardhome:v0.107.43@sha256:4016a420451810959f782d3cbe04c620d83c3431cbb13ae27aabd2921db482a0
        network_mode: host
        privileged: true
        volumes:
            - 'adguardhome_work:/opt/adguardhome/work:rw'
            - 'adguardhome_conf:/opt/adguardhome/conf:rw'
        command:
            - "--no-check-update"
            - "--web-addr"
            - "0.0.0.0:80"
            - "--config"
            - "/opt/adguardhome/conf/AdGuardHome.yaml"

    # https://github.com/balenablocks/hostname
    hostname:
        image: balenablocks/hostname:latest@sha256:b923d6ea886ec48125d2c49e431638d2ef6f4adac574b729b4135cfade3ffdce
        restart: no
        labels:
            io.balena.features.supervisor-api: 1
        environment:
            SET_HOSTNAME: adguard
