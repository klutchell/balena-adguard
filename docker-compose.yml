version: '2.1'

volumes:
    adguardhome_work:
    adguardhome_conf:

services:

    # https://hub.docker.com/r/adguard/adguardhome
    adguard:
        image: adguard/adguardhome:v0.107.35@sha256:44dfbf682dbd8cdab1d4987402e99b09e48a521bcab19674939eb73a6b420bac
        network_mode: host
        privileged: true
        volumes:
            - 'adguardhome_work:/opt/adguardhome/work:rw'
            - 'adguardhome_conf:/opt/adguardhome/conf:rw'
        command:
            - "--no-check-update"
            - "--web-addr"
            - "0.0.0.0:80"
            - "--config"
            - "/opt/adguardhome/conf/AdGuardHome.yaml"

    # https://github.com/balenablocks/hostname
    hostname:
        image: balenablocks/hostname:latest
        restart: no
        labels:
            io.balena.features.supervisor-api: 1
        environment:
            SET_HOSTNAME: adguard
