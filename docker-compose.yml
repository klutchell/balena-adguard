version: '2.1'

volumes:
    adguardhome_work:
    adguardhome_conf:

services:

    # https://hub.docker.com/r/adguard/adguardhome
    adguard:
        image: adguard/adguardhome:v0.107.28
        network_mode: host
        privileged: true
        volumes:
            - 'adguardhome_work:/opt/adguardhome/work:rw'
            - 'adguardhome_conf:/opt/adguardhome/conf:rw'
        command:
            - "/opt/adguardhome/AdGuardHome"
            - "--no-check-update"
            - "--host"
            - "0.0.0.0"
            - "--port"
            - "80"
            - "--config"
            - "/opt/adguardhome/conf/AdGuardHome.yaml"

    # https://github.com/balenablocks/hostname
    hostname:
        image: balenablocks/hostname:latest
        restart: no
        labels:
            io.balena.features.supervisor-api: 1
        environment:
            SET_HOSTNAME: adguard
