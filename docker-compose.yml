version: '2.1'

volumes:
    adguardhome_work:
    adguardhome_conf:

services:

    # https://hub.docker.com/r/adguard/adguardhome
    adguard:
        image: adguard/adguardhome:v0.107.40@sha256:efe08a321f2328e72e2d173818fb08ce25a2af5fbb94ad80cf4ddb04f79a95cc
        network_mode: host
        privileged: true
        volumes:
            - 'adguardhome_work:/opt/adguardhome/work:rw'
            - 'adguardhome_conf:/opt/adguardhome/conf:rw'
        command:
            - "--no-check-update"
            - "--web-addr"
            - "0.0.0.0:80"
            - "--config"
            - "/opt/adguardhome/conf/AdGuardHome.yaml"

    # https://github.com/balenablocks/hostname
    hostname:
        image: balenablocks/hostname:latest@sha256:b923d6ea886ec48125d2c49e431638d2ef6f4adac574b729b4135cfade3ffdce
        restart: no
        labels:
            io.balena.features.supervisor-api: 1
        environment:
            SET_HOSTNAME: adguard
